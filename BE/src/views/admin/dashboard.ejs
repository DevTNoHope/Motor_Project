<div class="space-y-8">

  <div class="flex items-center justify-between"></div>

  <!-- Quick Stats -->
  <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">

    <div class="bg-white shadow rounded-xl p-4 flex flex-col items-start">
      <span class="text-slate-500 text-sm">Thá»£ sá»­a xe</span>
      <span class="text-2xl font-semibold text-emerald-600"><%= stats.mechanics %></span>
    </div>

    <div class="bg-white shadow rounded-xl p-4 flex flex-col items-start">
      <span class="text-slate-500 text-sm">Dá»‹ch vá»¥</span>
      <span class="text-2xl font-semibold text-indigo-600"><%= stats.services %></span>
    </div>

    <div class="bg-white shadow rounded-xl p-4 flex flex-col items-start">
      <span class="text-slate-500 text-sm">Phá»¥ tÃ¹ng</span>
      <span class="text-2xl font-semibold text-amber-600"><%= stats.parts %></span>
    </div>

    <div class="bg-white shadow rounded-xl p-4 flex flex-col items-start">
      <span class="text-slate-500 text-sm">Loáº¡i phá»¥ tÃ¹ng</span>
      <span class="text-2xl font-semibold text-purple-600"><%= stats.partTypes %></span>
    </div>

    <div class="bg-white shadow rounded-xl p-4 flex flex-col items-start">
      <span class="text-slate-500 text-sm">NhÃ  cung cáº¥p</span>
      <span class="text-2xl font-semibold text-pink-600"><%= stats.suppliers %></span>
    </div>

    <div class="bg-white shadow rounded-xl p-4 flex flex-col items-start">
      <span class="text-slate-500 text-sm">Phiáº¿u nháº­p hÃ ng</span>
      <span class="text-2xl font-semibold text-lime-600"><%= stats.purchaseOrders %></span>
    </div>

  </div>


  <!-- ===================== THá»NG KÃŠ NÃ‚NG CAO ===================== -->
  <h2 class="text-xl font-semibold mt-10">Thá»‘ng kÃª hoáº¡t Ä‘á»™ng</h2>

  <!-- Advanced Stats -->
  <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-4">

    <div class="bg-white shadow rounded-xl p-4 flex flex-col items-start">
      <span class="text-slate-500 text-sm">Tá»•ng sá»‘ Ä‘Æ¡n</span>
      <span class="text-2xl font-semibold text-emerald-700"><%= advanced.totalBookings %></span>
    </div>

    <div class="bg-white shadow rounded-xl p-4 flex flex-col items-start">
      <span class="text-slate-500 text-sm">Tá»•ng doanh thu</span>
      <span class="text-2xl font-semibold text-blue-700">
        <%= (advanced.totalRevenue || 0).toLocaleString() %> â‚«
      </span>
    </div>

    <div class="bg-white shadow rounded-xl p-4 flex flex-col items-start">
      <span class="text-slate-500 text-sm">ÄÆ¡n hoÃ n thÃ nh</span>
      <span class="text-2xl font-semibold text-purple-700"><%= advanced.completedBookings %></span>
    </div>

  </div>


  <!-- Revenue Chart -->
  <div class="bg-white shadow rounded-xl p-6 mt-8">
    <h3 class="text-lg font-semibold mb-4">Doanh thu theo thÃ¡ng</h3>
    <canvas id="revenueChart" height="100"></canvas>
  </div>


  <!-- Top Services -->
  <div class="bg-white shadow rounded-xl p-6 mt-8">
    <h3 class="text-lg font-semibold mb-4">Top 5 dá»‹ch vá»¥ Ä‘Æ°á»£c Ä‘áº·t nhiá»u nháº¥t</h3>

    <ul class="divide-y">
      <% if (advanced.topServices && advanced.topServices.length) { %>
        <% advanced.topServices.forEach(function(s) { %>
          <li class="flex justify-between py-2">
            <span><%= s.name %></span>
            <span class="font-semibold"><%= s.total %> lÆ°á»£t</span>
          </li>
        <% }); %>
      <% } else { %>
        <p class="text-sm text-slate-500">ChÆ°a cÃ³ dá»¯ liá»‡u.</p>
      <% } %>
    </ul>
  </div>


  <!-- Footer -->
  <div class="text-center text-sm text-slate-500 mt-8">
    <p>ğŸš— Há»‡ thá»‘ng quáº£n lÃ½ cá»­a hÃ ng sá»­a xe mÃ¡y</p>
    <p class="mt-1">Â© 2025 - Äá»“ Ã¡n chuyÃªn ngÃ nh</p>
  </div>

</div>


<!-- SAFE JSON PASSING -->
<div id="chart-data"
     data-labels='<%- JSON.stringify(advanced.monthly.map(function(m){ return m.month })) %>'
     data-values='<%- JSON.stringify(advanced.monthly.map(function(m){ return m.revenue })) %>'>
</div>


<!-- ChartJS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  // Láº¥y data an toÃ n tá»« HTML attribute
  const el = document.getElementById("chart-data");

  const revenueLabels = JSON.parse(el.dataset.labels);
  const revenueData   = JSON.parse(el.dataset.values);

  new Chart(document.getElementById("revenueChart"), {
    type: "line",
    data: {
      labels: revenueLabels,
      datasets: [{
        label: "Doanh thu (â‚«)",
        data: revenueData,
        borderWidth: 3,
        tension: 0.3,
      }],
    },
  });
</script>

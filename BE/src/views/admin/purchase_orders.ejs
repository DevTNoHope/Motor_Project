<h1 class="text-2xl font-semibold mb-4">Quản lý Phiếu nhập hàng</h1>

<div class="mb-4 flex justify-between">
  <a href="/admin/purchase-orders/new"
     class="px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700">
     + Tạo phiếu nhập mới
  </a>
</div>

<table class="w-full border border-slate-300 bg-white shadow-sm">
  <thead class="bg-slate-100">
    <tr>
      <th class="p-2 border text-center">#</th>
      <th class="p-2 border text-left">Nhà cung cấp</th>
      <th class="p-2 border text-left">Ghi chú</th>
      <th class="p-2 border text-center">Trạng thái</th>
      <th class="p-2 border text-center">Ngày tạo</th>
      <th class="p-2 border text-center">Hành động</th>
    </tr>
  </thead>
  <tbody>
    <% if (orders.length === 0) { %>
      <tr><td colspan="6" class="text-center p-4 text-gray-500">Chưa có phiếu nhập hàng nào</td></tr>
    <% } else { %>
      <% orders.forEach((o, i) => { %>
        <tr class="hover:bg-slate-50">
          <td class="p-2 border text-center"><%= i + 1 %></td>
          <td class="p-2 border"><%= o.Supplier?.name || '-' %></td>
          <td class="p-2 border"><%- o.note || '-' %></td>

          <td class="p-2 border text-center">
            <span class="px-2 py-1 text-xs rounded <%= o.status === 'RECEIVED' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700' %>">
              <%= o.status %>
            </span>
          </td>
          <td class="p-2 border text-center"><%= o.created_at?.toLocaleString() || '-' %></td>
          <td class="p-2 border text-center space-x-2">
            <a href="/admin/purchase-orders/<%= o.id %>/edit" class="text-blue-600 hover:underline">Chi tiết</a>

            <% if (o.status === 'DRAFT') { %>
              <form action="/admin/purchase-orders/<%= o.id %>/receive" method="POST" class="inline">
                <input type="hidden" name="_method" value="PATCH">
                <button type="submit" class="text-green-600 hover:underline ml-1"
                        onclick="return confirm('Xác nhận nhập kho cho phiếu này?')">
                  Nhập kho
                </button>
              </form>

              <form action="/admin/purchase-orders/<%= o.id %>" method="POST" class="inline">
                <input type="hidden" name="_method" value="DELETE">
                <button type="submit" class="text-red-600 hover:underline ml-2"
                        onclick="return confirm('Xóa phiếu này?')">
                  Xóa
                </button>
              </form>
            <% } %>
          </td>
        </tr>
      <% }) %>
    <% } %>
  </tbody>
</table>

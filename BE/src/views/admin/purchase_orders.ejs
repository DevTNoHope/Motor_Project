<% layout('layouts/admin') %>
<h1 class="text-2xl font-semibold mb-4">Phi·∫øu nh·∫≠p h√†ng</h1>

<div class="mb-4">
  <a href="/admin/purchase-orders/new"
     class="px-4 py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700">
     + T·∫°o phi·∫øu nh·∫≠p m·ªõi
  </a>
</div>

<table class="w-full border border-slate-300 bg-white">
  <thead class="bg-slate-100">
    <tr>
      <th class="p-2 border">#</th>
      <th class="p-2 border">Nh√† cung c·∫•p</th>
      <th class="p-2 border">Ng∆∞·ªùi l·∫≠p</th>
      <th class="p-2 border">Ng√†y t·∫°o</th>
      <th class="p-2 border">Tr·∫°ng th√°i</th>
      <th class="p-2 border">H√†nh ƒë·ªông</th>
    </tr>
  </thead>
  <tbody>
    <% orders.forEach((po, i) => { %>
    <tr class="hover:bg-slate-50">
      <td class="p-2 border text-center"><%= i + 1 %></td>
      <td class="p-2 border"><%= po.supplier?.name || 'N/A' %></td>
      <td class="p-2 border"><%= po.created_by_name || 'Admin' %></td>
      <td class="p-2 border text-center"><%= po.created_at.toLocaleString() %></td>
      <td class="p-2 border text-center">
        <%= po.status === 'DRAFT' ? 'üìù DRAFT' :
            po.status === 'RECEIVED' ? '‚úÖ RECEIVED' : '‚ùå CANCELED' %>
      </td>
      <td class="p-2 border text-center">
        <a href="/admin/purchase-orders/<%= po.id %>" class="text-blue-600 hover:underline">Chi ti·∫øt</a>
        <% if (po.status === 'DRAFT') { %>
        <form action="/admin/purchase-orders/<%= po.id %>?_method=DELETE" method="POST" class="inline">
          <button class="text-red-600 hover:underline ml-2"
                  onclick="return confirm('X√≥a phi·∫øu n√†y?')">X√≥a</button>
        </form>
        <% } %>
      </td>
    </tr>
    <% }) %>
  </tbody>
</table>
